# Test profile configuration
# Testcontainers provides datasource config via @ServiceConnection

spring:
  # Provide mock OAuth2 credentials to satisfy Spring Security's validation.
  # These are never used in tests but required for context loading.
  security:
    oauth2:
      client:
        registration:
          github:
            client-id: test-client-id
            client-secret: test-client-secret

  jpa:
    hibernate:
      ddl-auto: none  # Liquibase handles schema creation
    show-sql: true

  # Ensure Liquibase runs in tests
  liquibase:
    enabled: true
    change-log: classpath:db/changelog/db.changelog-master.yaml

# Disable eager cache loading in tests (faster startup)
nextskip:
  refresh:
    eager-load: false
  # Disable MQTT ingestion during tests to prevent test pollution
  spots:
    enabled: false

# db-scheduler disabled for test isolation
# Scheduler tests use application-scheduler-test.yml profile instead
db-scheduler:
  enabled: false

# Reduce logging noise in tests
logging:
  level:
    org.testcontainers: WARN
    com.github.dockerjava: WARN
    org.hibernate.SQL: DEBUG
    liquibase: DEBUG
    org.springframework.boot.autoconfigure.liquibase: DEBUG
